import{c as Ce,d as we,e as xe,f as Me,n as Ee,o as Fe,p as Ie,q as ke,s as Ae,t as Pe,u as Ve}from"./chunk-FEG44FXT.js";import{c as De,d as be}from"./chunk-4BZJI3GO.js";import{$ as A,Ia as _e,Ja as ve,Ka as Se,La as Te,W as k,fa as me,ia as ue,ma as ce,pa as ge,ra as he,za as fe}from"./chunk-UXAPX6VQ.js";import{c as le,d as L,f as I,h as O}from"./chunk-S35HUXPS.js";import{a as ye}from"./chunk-IBS6PDH7.js";import{d as de,f as pe}from"./chunk-N63SZ2MC.js";import{b as se}from"./chunk-QIMRRRQA.js";import{Ab as m,Bb as $,Cb as T,Da as l,Ea as x,Eb as h,Fb as f,Gb as y,Hb as F,Ib as ee,Oa as S,Pa as G,Q as E,R as q,Rb as te,Sa as J,V as W,Va as v,W as U,a as b,ab as K,b as C,bb as d,ca as u,da as c,db as M,fb as Q,ga as N,jc as ie,kb as a,kc as ne,lb as r,lc as oe,mb as g,mc as re,nb as j,o as _,ob as B,oc as ae,qb as Y,rb as R,sb as z,z as w,zb as Z}from"./chunk-73DFFZXF.js";var Be=({dt:t})=>`
.p-skeleton {
    overflow: hidden;
    background: ${t("skeleton.background")};
    border-radius: ${t("skeleton.border.radius")};
}

.p-skeleton::after {
    content: "";
    animation: p-skeleton-animation 1.2s infinite;
    height: 100%;
    left: 0;
    position: absolute;
    right: 0;
    top: 0;
    transform: translateX(-100%);
    z-index: 1;
    background: linear-gradient(90deg, rgba(255, 255, 255, 0), ${t("skeleton.animation.background")}, rgba(255, 255, 255, 0));
}

[dir='rtl'] .p-skeleton::after {
    animation-name: p-skeleton-animation-rtl;
}

.p-skeleton-circle {
    border-radius: 50%;
}

.p-skeleton-animation-none::after {
    animation: none;
}

@keyframes p-skeleton-animation {
    from {
        transform: translateX(-100%);
    }
    to {
        transform: translateX(100%);
    }
}

@keyframes p-skeleton-animation-rtl {
    from {
        transform: translateX(100%);
    }
    to {
        transform: translateX(-100%);
    }
}
`,Re={root:{position:"relative"}},ze={root:({props:t})=>["p-skeleton p-component",{"p-skeleton-circle":t.shape==="circle","p-skeleton-animation-none":t.animation==="none"}]},We=(()=>{class t extends me{name="skeleton";theme=Be;classes=ze;inlineStyles=Re;static \u0275fac=(()=>{let i;return function(s){return(i||(i=N(t)))(s||t)}})();static \u0275prov=E({token:t,factory:t.\u0275fac})}return t})();var X=(()=>{class t extends ue{styleClass;style;shape="rectangle";animation="wave";borderRadius;size;width="100%";height="1rem";_componentStyle=U(We);containerClass(){return{"p-skeleton p-component":!0,"p-skeleton-circle":this.shape==="circle","p-skeleton-animation-none":this.animation==="none"}}get containerStyle(){let i=this._componentStyle?.inlineStyles.root,e;return this.size?e=C(b(b({},this.style),i),{width:this.size,height:this.size,borderRadius:this.borderRadius}):e=b(C(b({},i),{width:this.width,height:this.height,borderRadius:this.borderRadius}),this.style),e}static \u0275fac=(()=>{let i;return function(s){return(i||(i=N(t)))(s||t)}})();static \u0275cmp=S({type:t,selectors:[["p-skeleton"]],inputs:{styleClass:"styleClass",style:"style",shape:"shape",animation:"animation",borderRadius:"borderRadius",size:"size",width:"width",height:"height"},features:[F([We]),J],decls:1,vars:7,consts:[[3,"ngClass","ngStyle"]],template:function(e,s){e&1&&g(0,"div",0),e&2&&(Q(s.styleClass),d("ngClass",s.containerClass())("ngStyle",s.containerStyle),K("data-pc-name","skeleton")("aria-hidden",!0)("data-pc-section","root"))},dependencies:[ae,ie,re,A],encapsulation:2,changeDetection:0})}return t})(),ut=(()=>{class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=G({type:t});static \u0275inj=q({imports:[X,A,A]})}return t})();var P=class t{constructor(o,i){this.http=o;this.router=i}getOptions(){return this.http.get("http://127.0.0.1:8000/api/dieta/options",{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).pipe(w(o=>o.status===401||o.status===403?(localStorage.removeItem("authToken"),this.router.navigate(["/login"]),_(()=>new Error("No autorizado. Redirigiendo al login..."))):_(()=>o)))}getDiet(o){return this.http.get("http://127.0.0.1:8000/api/dieta/"+o,{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).pipe(w(i=>i.status===401||i.status===403?(localStorage.removeItem("authToken"),this.router.navigate(["/login"]),_(()=>new Error("No autorizado. Redirigiendo al login..."))):_(()=>i)))}getDietsHistory(o){return this.http.get("http://127.0.0.1:8000/api/dieta/history/"+o,{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).pipe(w(i=>i.status===401||i.status===403?(localStorage.removeItem("authToken"),this.router.navigate(["/login"]),_(()=>new Error("No autorizado. Redirigiendo al login..."))):_(()=>i)))}insertDiet(o,i,e,s,p,n){return this.http.post("http://127.0.0.1:8000/api/dieta/new",{pac_id:o,textureId:i,dietTypes:e,autonomy:s,prosthesis:p,aux_number:n},{headers:{Authorization:"Bearer "+localStorage.getItem("authToken")}}).pipe(w(D=>D.status===401||D.status===403?(localStorage.removeItem("authToken"),this.router.navigate(["/login"]),_(()=>new Error("No autorizado. Redirigiendo al login..."))):_(()=>D)))}static \u0275fac=function(i){return new(i||t)(W(se),W(pe))};static \u0275prov=E({token:t,factory:t.\u0275fac})};var Xe=()=>[];function qe(t,o){t&1&&g(0,"p-message",40)}function Ue(t,o){t&1&&g(0,"p-message",41)}function Ge(t,o){t&1&&g(0,"p-message",42)}function Je(t,o){t&1&&g(0,"p-message",43)}function Ke(t,o){t&1&&(j(0),g(1,"p-skeleton",46),B())}function Qe(t,o){t&1&&(j(0),a(1,"div",44),v(2,Ke,2,0,"ng-container",45),r(),B()),t&2&&(l(),d("@fadeAnimation",void 0),l(),d("ngForOf",ee(2,Xe).constructor(5)))}function Ye(t,o){if(t&1&&(a(0,"div",49)(1,"div",50)(2,"h4",51),m(3),r(),a(4,"p",52),m(5),r(),a(6,"p"),m(7),r(),a(8,"p"),m(9),r(),a(10,"p"),m(11),r(),a(12,"p"),m(13),r()()()),t&2){let i,e=o.$implicit;l(3),T("Dia ",e.reg_fecha,""),l(2),$(e.reg_hora),l(2),T("Textura: ",(i=e.Die_TText==null?null:e.Die_TText.descripcion)!==null&&i!==void 0?i:"-",""),l(2),T("Tipus de dieta: ",e.tipos_dietas,""),l(2),T("Aut\xF2nom o ajuda: ",e.Die_Autonomo===!0?"Aut\xF2nom":"Ajuda",""),l(2),T("Portador de pr\xF2tesi: ",e.Die_Protesi===!0?"S\xED":"No","")}}function Ze(t,o){if(t&1&&(a(0,"div",44),v(1,Ye,14,6,"div",48),r()),t&2){let i=z(2);d("@fadeAnimation",void 0),l(),d("ngForOf",i.historyDiet)}}function $e(t,o){if(t&1&&v(0,Ze,2,2,"div",47),t&2){let i=z();d("ngIf",i.historyDiet.length>0)}}var V=class t{constructor(o,i,e,s){this.dietsService=o;this.AuthService=i;this.route=e;this.messageService=s}selectedTexture=null;historyDiet=[];selectedDietType=[];selectedAutonomy=null;hasProsthesis=void 0;lastDietText="";lastDietType="";lastDietHelp="";lastDietProte="";id="";pac_id="";loading=!0;response=null;submitted=!1;dietHistoryLoading=!1;dietTextures=[{name:"",code:""}];dietTypes=[];autonomyOptions=[{name:"Aut\xF2nom",code:"AUTO"},{name:"Ajuda",code:"HELP"}];ngOnInit(){this.route.params.subscribe(o=>{this.id=o.id??""}),this.dietsService.getOptions().subscribe({next:o=>{this.response=o,this.response.data.tipos_dieta.forEach(i=>{this.dietTypes.push({name:i.descripcion,code:i.id.toString()})}),this.response.data.tipos_textura.forEach(i=>{this.dietTextures.push({name:i.descripcion,code:i.id.toString()})})},complete:()=>{this.dietTextures.shift(),this.loading=!1}}),this.id&&this.searchDiet()}searchDiet(){this.id&&(this.loading=!0,this.lastDietText="",this.lastDietType="",this.lastDietHelp="",this.lastDietProte="",this.dietsService.getDiet(this.id).subscribe({next:o=>{this.response=o,this.pac_id=this.response.data.pac_id,this.response.message==="noDiet"?(this.historyDiet=[],this.messageService.add({severity:"warn",summary:"Advert\xE8ncia",detail:"Aquest pacient no t\xE9 dieta assignada"})):(this.lastDietText=this.response.data.Die_TText?.descripcion??"",this.lastDietType=(this.response.data.Tipos_Dietas??[]).map(i=>i.descripcion).join(", "),this.lastDietHelp=this.response.data.Die_Autonomo===!0?"Aut\xF2nom":"Ajuda",this.lastDietProte=this.response.data.Die_Protesi===!0?"S\xED":"No",this.dietsService.getDietsHistory(this.pac_id).subscribe({next:i=>{this.historyDiet=i.data.history.map(e=>{let s="",p="";if(e.reg_timestamp){let[D,je]=e.reg_timestamp.split(" ");s=D,p=je}let n=e.Tipos_Dietas&&Array.isArray(e.Tipos_Dietas)?e.Tipos_Dietas.map(D=>D.descripcion).join(", "):"-";return C(b({},e),{reg_fecha:s,reg_hora:p,tiposDietas:n})})},error:i=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error al carregar la hist\xF2ria de la dieta"})}}))},error:o=>{o.error.message==="noPatient"&&(this.historyDiet=[],this.messageService.add({severity:"error",summary:"Advert\xE8ncia",detail:"Aquesta habitaci\xF3 no t\xE9 pacient assignat"})),o.error.message==="roomNotFound"&&(this.historyDiet=[],this.messageService.add({severity:"error",summary:"Error",detail:"Aquesta habitaci\xF3 no existeix"})),this.lastDietText="",this.lastDietType="",this.lastDietHelp="",this.lastDietProte="",this.loading=!1},complete:()=>{this.loading=!1}}))}newDiet(){if(this.submitted=!0,this.hasProsthesis===void 0&&(this.hasProsthesis=!1),this.pac_id&&this.selectedTexture&&this.selectedDietType.length>0&&this.selectedAutonomy&&this.hasProsthesis!==void 0){this.loading=!0;let o=this.selectedTexture?.trim(),i=this.selectedDietType.map(n=>n.trim()),e=this.selectedAutonomy=="AUTO",s=this.hasProsthesis,p=Number(this.AuthService.getAuxiliarId());if(!p){this.loading=!1;return}this.dietsService.insertDiet(this.pac_id,o,i,e,s,p).subscribe({next:n=>{this.messageService.add({severity:"success",summary:"Dieta assignada",detail:"Dieta assignada correctament"})},error:n=>{this.loading=!1},complete:()=>{this.searchDiet(),this.loading=!1}})}}static \u0275fac=function(i){return new(i||t)(x(P),x(ye),x(de),x(k))};static \u0275cmp=S({type:t,selectors:[["app-diets-form"]],features:[F([k])],decls:63,vars:49,consts:[["historyDietBlock",""],["position","top-right"],[1,"card","flex","flex-col","items-center","gap-4"],[1,"font-semibold","text-xl"],[1,"flex","flex-wrap","items-center","gap-6"],[1,"field"],["for","numRoom",1,"sr-only"],["pInputText","","id","numRoom","type","text","placeholder","Num habitaci\xF3",3,"ngModelChange","ngModel"],["severity","error","text","El n\xFAmero d'habitaci\xF3 \xE9s obligatori",4,"ngIf"],["label","Trobar dieta",3,"onClick","loading","disabled","fluid"],["label","Aplicar nova dieta",3,"onClick","loading","disabled","fluid"],[1,"flex","flex-col","md:flex-row","gap-8"],[1,"md:w-1/2"],[1,"card","flex","flex-col","gap-4","h-[350px]"],[1,"flex","flex-col","gap-2"],["for","textures"],["id","textures","optionLabel","name","optionValue","code","placeholder","Selecciona una textura",1,"w-full",3,"ngModelChange","ngModel","options","loading"],["severity","error","text","La textura \xE9s obligat\xF2ria",4,"ngIf"],["for","dietType"],["id","dietType","optionLabel","name","optionValue","code","placeholder","Selecciona prefer\xE8ncies",1,"w-full",3,"ngModelChange","ngModel","options","loading","showToggleAll","filter"],["severity","error","text","El tipus de dieta \xE9s obligatori",4,"ngIf"],["for","autonomy"],["id","autonomy","optionLabel","name","optionValue","code","placeholder","Selecciona una opci\xF3",1,"w-full",3,"ngModelChange","ngModel","options"],["severity","error","text","L'autonomia \xE9s obligat\xF2ria",4,"ngIf"],[1,"flex","flex-wrap","gap-2"],["for","prosthesis"],["id","prosthesis",3,"ngModelChange","ngModel","binary"],[1,"card","flex","flex-col","gap-8","h-[350px]"],[1,"grid","grid-cols-12","gap-4"],["for","lastDietText",1,"flex","items-center","col-span-12","mb-2","md:col-span-2","md:mb-0"],[1,"col-span-12","md:col-span-10"],["pInputText","","id","lastDietText","type","text",3,"ngModelChange","disabled","ngModel"],["for","lastDietType",1,"flex","items-center","col-span-12","mb-2","md:col-span-2","md:mb-0"],["pInputText","","id","lastDietType","type","text",3,"ngModelChange","disabled","ngModel"],[1,"grid","grid-cols-12","gap-4","grid-cols-12","gap-2"],["for","lastDietHelp",1,"flex","items-center","col-span-12","mb-2","md:col-span-2","md:mb-0"],["pInputText","","id","lastDietHelp","type","text",3,"ngModelChange","disabled","ngModel"],["for","lastDietProte",1,"flex","items-center","col-span-12","mb-2","md:col-span-2","md:mb-0"],["pInputText","","id","lastDietProte","type","text",3,"ngModelChange","disabled","ngModel"],[4,"ngIf","ngIfElse"],["severity","error","text","El n\xFAmero d'habitaci\xF3 \xE9s obligatori"],["severity","error","text","La textura \xE9s obligat\xF2ria"],["severity","error","text","El tipus de dieta \xE9s obligatori"],["severity","error","text","L'autonomia \xE9s obligat\xF2ria"],[1,"card","flex","gap-4","mt-8","overflow-x-auto","h-auto"],[4,"ngFor","ngForOf"],["height","180px",1,"w-[300px]","transition-all"],["class","card flex gap-4 mt-8 overflow-x-auto h-auto",4,"ngIf"],["class"," !p-0",4,"ngFor","ngForOf"],[1,"!p-0"],[1,"card","!border","border-[var(--surface-border)]","w-[300px]"],[1,"mb-0"],[1,"mb-6","text-gray-600","text-lg"]],template:function(i,e){if(i&1){let s=Y();a(0,"p-fluid"),g(1,"p-toast",1),a(2,"div",2)(3,"div",3),m(4,"Introdueix un num d'habitaci\xF3"),r(),a(5,"div",4)(6,"div",5),g(7,"label",6),a(8,"input",7),y("ngModelChange",function(n){return u(s),f(e.id,n)||(e.id=n),c(n)}),r(),v(9,qe,1,0,"p-message",8),r(),a(10,"p-button",9),R("onClick",function(){return u(s),c(e.searchDiet())}),r(),a(11,"p-button",10),R("onClick",function(){return u(s),c(e.newDiet())}),r()()(),a(12,"div",11)(13,"div",12)(14,"div",13)(15,"div",3),m(16,"Nova dieta"),r(),a(17,"div",14)(18,"label",15),m(19,"Textures"),r(),a(20,"p-select",16),y("ngModelChange",function(n){return u(s),f(e.selectedTexture,n)||(e.selectedTexture=n),c(n)}),r(),v(21,Ue,1,0,"p-message",17),r(),a(22,"div",14)(23,"label",18),m(24,"Tipus de dieta"),r(),a(25,"p-multiSelect",19),y("ngModelChange",function(n){return u(s),f(e.selectedDietType,n)||(e.selectedDietType=n),c(n)}),r(),v(26,Ge,1,0,"p-message",20),r(),a(27,"div",14)(28,"label",21),m(29,"Aut\xF2nom o ajuda"),r(),a(30,"p-select",22),y("ngModelChange",function(n){return u(s),f(e.selectedAutonomy,n)||(e.selectedAutonomy=n),c(n)}),r(),v(31,Je,1,0,"p-message",23),r(),a(32,"div",24)(33,"label",25),m(34,"Portador de pr\xF2tesi"),r(),a(35,"p-checkbox",26),y("ngModelChange",function(n){return u(s),f(e.hasProsthesis,n)||(e.hasProsthesis=n),c(n)}),r()()()(),a(36,"div",12)(37,"div",27)(38,"div",3),m(39,"Dieta actual"),r(),a(40,"div",28)(41,"label",29),m(42,"Textures:"),r(),a(43,"div",30)(44,"input",31),y("ngModelChange",function(n){return u(s),f(e.lastDietText,n)||(e.lastDietText=n),c(n)}),r()()(),a(45,"div",28)(46,"label",32),m(47,"Tipus de dieta:"),r(),a(48,"div",30)(49,"input",33),y("ngModelChange",function(n){return u(s),f(e.lastDietType,n)||(e.lastDietType=n),c(n)}),r()()(),a(50,"div",34)(51,"label",35),m(52,"Aut\xF2nom o ajuda:"),r(),a(53,"div",30)(54,"input",36),y("ngModelChange",function(n){return u(s),f(e.lastDietHelp,n)||(e.lastDietHelp=n),c(n)}),r()()(),a(55,"div",34)(56,"label",37),m(57,"Portador de pr\xF2tesi:"),r(),a(58,"div",30)(59,"input",38),y("ngModelChange",function(n){return u(s),f(e.lastDietProte,n)||(e.lastDietProte=n),c(n)}),r()()()()()(),v(60,Qe,3,3,"ng-container",39)(61,$e,1,1,"ng-template",null,0,te),r()}if(i&2){let s=Z(62);l(8),M("ng-invalid",!e.id&&e.submitted)("ng-dirty",e.submitted),h("ngModel",e.id),l(),d("ngIf",!e.id&&e.submitted),l(),d("loading",e.loading)("disabled",!e.id)("fluid",!1),l(),d("loading",e.loading)("disabled",!e.pac_id)("fluid",!1),l(9),M("ng-invalid",!e.selectedTexture&&e.submitted)("ng-dirty",e.submitted),h("ngModel",e.selectedTexture),d("options",e.dietTextures)("loading",e.loading),l(),d("ngIf",!e.selectedTexture&&e.submitted),l(4),M("ng-invalid",e.selectedDietType.length===0&&e.submitted)("ng-dirty",e.submitted),h("ngModel",e.selectedDietType),d("options",e.dietTypes)("loading",e.loading)("showToggleAll",!1)("filter",!0),l(),d("ngIf",(e.selectedDietType==null?null:e.selectedDietType.length)===0&&e.submitted),l(4),M("ng-invalid",!e.selectedAutonomy&&e.submitted)("ng-dirty",e.submitted),h("ngModel",e.selectedAutonomy),d("options",e.autonomyOptions),l(),d("ngIf",!e.selectedAutonomy&&e.submitted),l(4),h("ngModel",e.hasProsthesis),d("binary",!0),l(9),d("disabled",!0),h("ngModel",e.lastDietText),l(5),d("disabled",!0),h("ngModel",e.lastDietType),l(5),d("disabled",!0),h("ngModel",e.lastDietHelp),l(5),d("disabled",!0),h("ngModel",e.lastDietProte),l(),d("ngIf",e.loading)("ngIfElse",s)}},dependencies:[Te,Se,we,Ce,ve,_e,ke,Ie,fe,ce,ge,he,Ae,be,De,Fe,Ee,Ve,Pe,Me,xe,oe,ne,X],encapsulation:2,data:{animation:[le("fadeAnimation",[O(":enter",[I({opacity:0}),L("600ms ease-in",I({opacity:1}))]),O(":leave",[L("400ms ease-out",I({opacity:0}))])])]}})};var Ne=class t{static \u0275fac=function(i){return new(i||t)};static \u0275cmp=S({type:t,selectors:[["app-diets"]],decls:1,vars:0,template:function(i,e){i&1&&g(0,"app-diets-form")},dependencies:[V],encapsulation:2})};export{X as a,ut as b,P as c,Ne as d};
